{"Steps":[{"Name":"schedule","Value":{"Rule":null,"CronOptions":{"day":null,"hour":"0","minute":"0","month":"*","weekDay":null,"year":"*"}}},{"Name":"sfn","Value":{"IRuleTarget":null,"INextable":null,"Name":"sfn","Chain":null}},{"Name":"aws","Value":{"LambdaInvoke":null,"Script":"#!/usr/bin/env python3\n# Borrowed from https://gist.github.com/dagrz/9b006d116302ba9dc4a1234b867c30c7, thanks dagrz!\n\nimport json\nimport sys\nimport awscli.clidriver\nfrom io import StringIO\n\ndriver = awscli.clidriver.create_clidriver()\n\n\ndef lambda_handler(event, context):\n    old_stdout = sys.stdout\n    sys.stdout = mystdout = StringIO()\n\n    driver.main(args=event['command'])\n\n    sys.stdout = old_stdout\n\n    mystdout.seek(0)\n\n    return json.loads(mystdout.read())\n\n\nif __name__ == '__main__':\n    lambda_handler({'command': sys.argv[1:]}, {})\n    sys.exit(0)\n","Args":[".aws","ec2","describe-instances","-query","Reservations].Instances[]"],"IamStatementProps":[{"actions":["ec2:DescribeInstances"],"conditions":null,"effect":"","notActions":null,"notPrincipals":null,"notResources":null,"principals":null,"resources":["*"],"sid":null}],"Environment":{"PYTHONPATH":"/opt/awscli"}}},{"Name":"map","Value":{"IChain":null,"IIterator":null,"Map":null}}]}
